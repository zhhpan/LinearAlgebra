{% extends "bootstrap/base.html" %}

{% block content %}
<div class="container-fluid p-0">
    <div class="container mt-3">
        <a href="/" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-2"></i>è¿”å›ä¸»é¡µé¢
        </a>
    </div>
    <!-- ç†è®ºåŒºä¿æŒä¸å˜ -->
    <section class="theory-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xl-10">
                    <div class="equation-card">
                        <h2 class="equation-title">çº¿æ€§æ–¹ç¨‹ç»„åŸºç¡€</h2>

                        <h4 class="mt-4">ä¸€ã€çº¿æ€§æ–¹ç¨‹ç»„ä¸å‘é‡ç»„çš„å…³ç³»</h4>
                        <div class="formula-box">
                            <p>ä¸€ä¸ª$n$å…ƒ$m$æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ï¼š</p>
                            <p>\[
                            \begin{cases}
                            a_{11}x_1 + a_{12}x_2 + \dots + a_{1n}x_n = b_1 \\
                            a_{21}x_1 + a_{22}x_2 + \dots + a_{2n}x_n = b_2 \\
                            \vdots \\
                            a_{m1}x_1 + a_{m2}x_2 + \dots + a_{mn}x_n = b_m
                            \end{cases}
                            \]</p>

                            <p>çŸ©é˜µå½¢å¼è¡¨ç¤ºï¼š</p>
                            <p>\[ A \vec{x} = \vec{b} \]</p>

                            <p>å…·ä½“è¡¨è¾¾ä¸ºï¼š</p>
                            <p>\[
                            A = \begin{pmatrix}
                            a_{11} & a_{12} & \dots & a_{1n} \\
                            a_{21} & a_{22} & \dots & a_{2n} \\
                            \vdots & \vdots & \ddots & \vdots \\
                            a_{m1} & a_{m2} & \dots & a_{mn}
                            \end{pmatrix},\quad
                            \vec{x} = \begin{pmatrix}
                            x_1 \\ x_2 \\ \vdots \\ x_n
                            \end{pmatrix},\quad
                            \vec{b} = \begin{pmatrix}
                            b_1 \\ b_2 \\ \vdots \\ b_m
                            \end{pmatrix}
                            \]</p>

                            <p>ä¹Ÿå¯çœ‹ä½œå‘é‡ç»„çš„çº¿æ€§ç»„åˆï¼š</p>
                            <p>\[
                            x_1 \vec{a}_1 + x_2 \vec{a}_2 + \dots + x_n \vec{a}_n = \vec{b}
                            \]</p>
                            <p>å…¶ä¸­$\vec{a}_i$æ˜¯$A$çš„ç¬¬$i$åˆ—å‘é‡ã€‚</p>
                        </div>

                        <h4 class="mt-4">äºŒã€é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„</h4>
                        <div class="formula-box">
                            <p><strong>å®šä¹‰ï¼š</strong> å¸¸æ•°é¡¹å…¨ä¸ºé›¶ï¼š</p>
                            <p>\[ A \vec{x} = \vec{0} \]</p>

                            <p><strong>è§£çš„æ€§è´¨ï¼š</strong></p>
                            <p>è‹¥$\vec{x}_1$ã€$\vec{x}_2$æ˜¯è§£ï¼Œåˆ™ï¼š</p>
                            <p>\[
                            \forall c_1, c_2 \in \mathbb{R}, \quad c_1 \vec{x}_1 + c_2 \vec{x}_2 \text{ä¹Ÿæ˜¯è§£}
                            \]</p>

                            <p><strong>æœ‰è§£æ¡ä»¶ï¼š</strong></p>
                            <p>\[
                            \operatorname{rank}(A) = r < n \quad \Rightarrow \quad \text{æœ‰} \ n - r \ \text{ä¸ªè‡ªç”±å˜é‡ï¼Œå­˜åœ¨éé›¶è§£}
                            \]</p>

                            <p><strong>åŸºç¡€è§£ç³»ï¼š</strong></p>
                            <p>\[
                            \vec{x} = c_1 \vec{\xi}_1 + c_2 \vec{\xi}_2 + \dots + c_k \vec{\xi}_k
                            \]</p>
                            <p>å…¶ä¸­$k = n - r$ï¼Œ$\{\vec{\xi}_1, \dots, \vec{\xi}_k\}$ä¸ºçº¿æ€§æ— å…³çš„åŸºç¡€è§£ç³»ã€‚</p>
                        </div>

                        <h4 class="mt-4">ä¸‰ã€éé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„</h4>
                        <div class="formula-box">
                            <p><strong>å®šä¹‰ï¼š</strong> å¸¸æ•°é¡¹ä¸å…¨ä¸ºé›¶ï¼š</p>
                            <p>\[ A \vec{x} = \vec{b} \]</p>

                            <p><strong>æœ‰è§£æ¡ä»¶ï¼š</strong></p>
                            <p>\[
                            \operatorname{rank}(A) = \operatorname{rank}(A|\vec{b}) = r
                            \]</p>

                            <p><strong>è§£çš„ç»“æ„ï¼š</strong></p>
                            <p>è‹¥ç‰¹è§£$\vec{x}_p$å·²çŸ¥ï¼Œåˆ™é€šè§£ï¼š</p>
                            <p>\[
                            \vec{x} = \vec{x}_p + \vec{x}_h
                            \]</p>

                            <p>å…¶ä¸­$\vec{x}_h$æ˜¯å¯¹åº”çš„é½æ¬¡æ–¹ç¨‹$A \vec{x} = \vec{0}$çš„é€šè§£ï¼š</p>
                            <p>\[
                            \vec{x}_h = c_1 \vec{\xi}_1 + c_2 \vec{\xi}_2 + \dots + c_k \vec{\xi}_k
                            \]</p>

                            <p>å› æ­¤éé½æ¬¡æ–¹ç¨‹çš„é€šè§£ç»“æ„ä¸ºï¼š</p>
                            <p>\[
                            \vec{x} = \vec{x}_p + c_1 \vec{\xi}_1 + c_2 \vec{\xi}_2 + \dots + c_k \vec{\xi}_k
                            \]</p>
                        </div>

                        <h4 class="mt-4">å››ã€æ±‚è§£æ–¹æ³•</h4>
                        <div class="formula-box">
                            <p><strong>1. å…‹è±å§†æ³•åˆ™ï¼ˆCramer's Ruleï¼‰</strong></p>
                            <p>é€‚ç”¨äº$n$å…ƒ$n$æ¬¡çº¿æ€§æ–¹ç¨‹ç»„ï¼Œä¸”ï¼š</p>
                            <p>\[
                            D = |A| \neq 0
                            \]</p>

                            <p>è§£ä¸ºï¼š</p>
                            <p>\[
                            x_i = \frac{D_i}{D}, \quad i = 1,2,\dots,n
                            \]</p>

                            <p>å…¶ä¸­$D_i$ä¸ºå°†$A$çš„ç¬¬$i$åˆ—æ›¿æ¢ä¸ºå¸¸æ•°å‘é‡$\vec{b}$åçš„è¡Œåˆ—å¼ã€‚</p>

                            <p><strong>2. é«˜æ–¯æ¶ˆå…ƒæ³•</strong></p>
                            <p>å¢å¹¿çŸ©é˜µå½¢å¼ï¼š</p>
                            <p>\[
                            \left( A | \vec{b} \right)
                            \]</p>

                            <p>é€šè¿‡åˆç­‰è¡Œå˜æ¢ï¼ŒåŒ–ä¸ºè¡Œé˜¶æ¢¯å½¢çŸ©é˜µï¼š</p>
                            <p>\[
                            \begin{pmatrix}
                            1 & * & * & * \\
                            0 & 1 & * & * \\
                            0 & 0 & 1 & *
                            \end{pmatrix}
                            \]</p>

                            <p>å›ä»£å³å¯æ±‚å‡ºè§£çš„å…·ä½“å€¼ã€‚</p>

                            <p>è‹¥å‡ºç°å½¢å¦‚ï¼š</p>
                            <p>\[
                            0 = c \quad (c \neq 0)
                            \]</p>
                            <p>åˆ™æ–¹ç¨‹æ— è§£ï¼›
                            è‹¥æœ‰è‡ªç”±å˜é‡ï¼Œè§£ä¸ºæ— ç©·å¤šè§£ã€‚</p>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- æ¼”ç¤ºåŒº -->
    <section class="demo-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xl-10">
                    <h2 class="math-title mb-4">äº¤äº’æ¼”ç¤º</h2>

                    <div class="math-card mb-4">
                        <form method="POST">
                            <!-- æ–¹ç¨‹è¾“å…¥è¡¨æ ¼ -->
                            <div class="equation-table">
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead >
                                            <tr>
                                                <th>æ–¹ç¨‹</th>
                                                <th>xç³»æ•°</th>
                                                <th>yç³»æ•°</th>
                                                <th>zç³»æ•°</th>
                                                <th>å¸¸æ•°é¡¹</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>æ–¹ç¨‹1</td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="a1" value="{{ request.form.a1 }}" placeholder="aâ‚" required>
                                                </td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="b1" value="{{ request.form.b1 }}" placeholder="bâ‚" required>
                                                </td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="c1" value="{{ request.form.c1 }}" placeholder="câ‚" required>
                                                </td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="d1" value="{{ request.form.d1 }}" placeholder="dâ‚" required>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>æ–¹ç¨‹2</td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="a2" value="{{ request.form.a2 }}" placeholder="aâ‚‚" required>
                                                </td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="b2" value="{{ request.form.b2 }}" placeholder="bâ‚‚" required>
                                                </td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="c2" value="{{ request.form.c2 }}" placeholder="câ‚‚" required>
                                                </td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="d2" value="{{ request.form.d2 }}" placeholder="dâ‚‚" required>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>æ–¹ç¨‹3</td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="a3" value="{{ request.form.a3 }}" placeholder="aâ‚ƒ" required>
                                                </td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="b3" value="{{ request.form.b3 }}" placeholder="bâ‚ƒ" required>
                                                </td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="c3" value="{{ request.form.c3 }}" placeholder="câ‚ƒ" required>
                                                </td>
                                                <td>
                                                    <input type="number" step="any" class="form-control" name="d3" value="{{ request.form.d3 }}" placeholder="dâ‚ƒ" required>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="row mt-3">
{#                                <div class="col-md-6">#}
{#                                    <div class="form-check">#}
{#                                        <input class="form-check-input" type="checkbox"#}
{#                                               id="showSteps" name="showSteps">#}
{#                                        <label class="form-check-label" for="showSteps">#}
{#                                            æ˜¾ç¤ºè¯¦ç»†è®¡ç®—æ­¥éª¤#}
{#                                        </label>#}
{#                                    </div>#}
{#                                </div>#}
                                <div class="row mb-3">
                                    <label class="col-form-label col-md-2">è§£æ³•é€‰æ‹©ï¼š</label>
                                    <div class="col-md-10">
                                        <div class="btn-group" role="group">
                                            <input type="radio" class="btn-check" name="method" id="gauss" value="gauss" autocomplete="off" {% if method == 'gauss' %}checked{% endif %}>
                                            <label class="btn btn-outline-primary" for="gauss">é«˜æ–¯æ¶ˆå…ƒæ³•</label>

                                            <input type="radio" class="btn-check" name="method" id="cramer" value="cramer" autocomplete="off" {% if method == 'cramer' %}checked{% endif %}>
                                            <label class="btn btn-outline-primary" for="cramer">å…‹è±å§†æ³•åˆ™</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 text-end">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-calculator me-2"></i>ç«‹å³æ±‚è§£
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- ç»“æœå±•ç¤ºåŒºä¿æŒä¸å˜ -->
                    {% if result %}
                    <div class="math-card">
{#                        <h4 class="mb-3">æ±‚è§£ç»“æœ</h4>#}
{#                        <p><strong>åˆ¤æ–­ï¼š</strong>{{ result }}</p>#}

                        {% if latex_solution %}
                        <p><strong>è§£ï¼š</strong> <span class="katex-render">{{ latex_solution|safe }}</span></p>
                        {% endif %}

                        {% if image_url %}
                        <div class="mt-3">
                            <img src="{{ image_url }}" alt="ä¸‰å¹³é¢å›¾åƒ" class="img-fluid border rounded shadow">
                        </div>
                        {% endif %}
                    </div>
                    {% endif %}

                    {% if result %}
                    <div class="math-card mt-4">
                        <h4>æ±‚è§£ç»“æœï¼š</h4>
                        <p><strong>{{ message }}</strong></p>
                        <p>x = {{ result[0] }}, y = {{ result[1] }}, z = {{ result[2] }}</p>
                        <img src="{{ url_for('plot_solve') }}" class="img-fluid mt-3" alt="å¹³é¢å›¾åƒ">
                    </div>
                    {% elif message %}
                    <div class="alert alert-warning mt-4">{{ message }}</div>
                    {% endif %}

                    {% if method == 'cramer' and det_data %}
                    <!-- å…‹è±å§†æ³•åˆ™æ­¥éª¤å±•ç¤º -->
                    <div class="math-card mt-4">
                        <h4 class="mb-3">ğŸ“ å…‹è±å§†æ³•åˆ™è®¡ç®—æ­¥éª¤</h4>

                        <!-- æ­¥éª¤1ï¼šç³»æ•°çŸ©é˜µè¡Œåˆ—å¼ -->
                        <div class="step-card mb-4">
                            <div class="step-header text-primary">
                                <i class="fas fa-calculator me-2"></i>æ­¥éª¤ 1ï¼šè®¡ç®—ç³»æ•°çŸ©é˜µè¡Œåˆ—å¼ D
                            </div>
                            <div class="step-body">
                                <div class="katex-render">
                                    \[ D = \begin{vmatrix}
                                    {{ det_data.D.latex }}
                                    \end{vmatrix} = {{ "%.3f"|format(det_data.D.value) }} \]
                                </div>
                            </div>
                        </div>

                        {# ä»…å½“è¡Œåˆ—å¼Dâ‰ 0æ—¶æ˜¾ç¤ºåç»­æ­¥éª¤ #}
                        {% if det_data.D.value|abs > 1e-6 %}
                            <!-- æ­¥éª¤2ï¼šDxè¡Œåˆ—å¼ -->
                            <div class="step-card mb-4">
                                <div class="step-header text-success">
                                    <i class="fas fa-exchange-alt me-2"></i>æ­¥éª¤ 2ï¼šæ›¿æ¢ç¬¬ä¸€åˆ—è®¡ç®— Dx
                                </div>
                                <div class="step-body">
                                    <div class="katex-render">
                                        \[ D_x = \begin{vmatrix}
                                        {{ det_data.Dx.latex }}
                                        \end{vmatrix} = {{ "%.3f"|format(det_data.Dx.value) }} \]
                                    </div>
                                </div>
                            </div>

                            <!-- æ­¥éª¤3ï¼šDyè¡Œåˆ—å¼ -->
                            <div class="step-card mb-4">
                                <div class="step-header text-info">
                                    <i class="fas fa-retweet me-2"></i>æ­¥éª¤ 3ï¼šæ›¿æ¢ç¬¬äºŒåˆ—è®¡ç®— Dy
                                </div>
                                <div class="step-body">
                                    <div class="katex-render">
                                        \[ D_y = \begin{vmatrix}
                                        {{ det_data.Dy.latex }}
                                        \end{vmatrix} = {{ "%.3f"|format(det_data.Dy.value) }} \]
                                    </div>
                                </div>
                            </div>

                            <!-- æ­¥éª¤4ï¼šDzè¡Œåˆ—å¼ -->
                            <div class="step-card mb-4">
                                <div class="step-header text-warning">
                                    <i class="fas fa-sync-alt me-2"></i>æ­¥éª¤ 4ï¼šæ›¿æ¢ç¬¬ä¸‰åˆ—è®¡ç®— Dz
                                </div>
                                <div class="step-body">
                                    <div class="katex-render">
                                        \[ D_z = \begin{vmatrix}
                                        {{ det_data.Dz.latex }}
                                        \end{vmatrix} = {{ "%.3f"|format(det_data.Dz.value) }} \]
                                    </div>
                                </div>
                            </div>

                            <!-- æœ€ç»ˆè®¡ç®—ç»“æœ -->
                            <div class="result-card bg-light p-3 rounded">
                                <h5 class="text-danger mb-3">ğŸ‰ æœ€ç»ˆè®¡ç®—ç»“æœ</h5>
                                <div class="katex-render">
                                    \[
                                    \begin{aligned}
                                    x &= \frac{D_x}{D} = \frac{ {{ "%.3f"|format(det_data.Dx.value) }} }{ {{ "%.3f"|format(det_data.D.value) }} } = {{ result[0] }} \\[2ex]
                                    y &= \frac{D_y}{D} = \frac{ {{ "%.3f"|format(det_data.Dy.value) }} }{ {{ "%.3f"|format(det_data.D.value) }} } = {{ result[1] }} \\[2ex]
                                    z &= \frac{D_z}{D} = \frac{ {{ "%.3f"|format(det_data.Dz.value) }} }{ {{ "%.3f"|format(det_data.D.value) }} } = {{ result[2] }}
                                    \end{aligned}
                                    \]
                                </div>
                            </div>
                        {% else %}
                            <!-- è¡Œåˆ—å¼D=0æ—¶çš„é”™è¯¯æç¤º -->
                            <div class="alert alert-danger mt-3">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                {% if det_data.error %}
                                    {{ det_data.error }}
                                {% else %}
                                    è¡Œåˆ—å¼D = 0ï¼Œæ— æ³•åº”ç”¨å…‹è±å§†æ³•åˆ™
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                    {% endif %}

                    {% if method == 'gauss' and gauss_data %}
                    <!-- é«˜æ–¯æ¶ˆå…ƒæ­¥éª¤å±•ç¤º -->
                    <div class="math-card mt-4">
                        <h4 class="mb-4">ğŸ” é«˜æ–¯æ¶ˆå…ƒè¿‡ç¨‹ï¼ˆå…± {{ gauss_data|length }} æ­¥ï¼‰</h4>

                        <div class="timeline-steps">
                            {% for step in gauss_data %}
                            <div class="timeline-step {% if loop.last %}last-step{% endif %}">
                                <div class="step-marker">
                                    <span class="step-number">{{ loop.index }}</span>
                                </div>
                                <div class="step-content">
                                    <h5 class="step-title text-primary">
                                        <i class="fas fa-arrow-circle-right me-2"></i>{{ step.description }}
                                    </h5>
                                    <div class="matrix-display bg-white p-2 rounded shadow-sm">
                                        <div class="katex-render">
                                            \[ {{ step.latex }} \]
                                        </div>
                                    </div>
                                    {% if not loop.last %}
                                    <div class="step-arrow">
                                        <i class="fas fa-angle-double-down text-muted"></i>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>

                        <!-- æœ€ç»ˆç»“æœ -->
                        {% if result %}
                        <div class="final-result bg-success text-white p-3 mt-4 rounded">
                            <h5 class="mb-3">âœ… æ¶ˆå…ƒå®Œæˆï¼æœ€ç»ˆè§£ï¼š</h5>
                            <div class="katex-render fs-5">
                                \[
                                \begin{cases}
                                x = {{ result[0] }} \\[2ex]
                                y = {{ result[1] }} \\[2ex]
                                z = {{ result[2] }}
                                \end{cases}
                                \]
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    {% endif %}


                </div>
            </div>
        </div>
    </section>
</div>
{% endblock %}

{% block styles %}
{{ super() }}
<link href="static/katex/katex.min.css" rel="stylesheet">
<script defer src="static/katex/katex.min.js"></script>
<script defer src="static/katex/auto-render.min.js"
        onload="renderMathInElement(document.body, {
            delimiters: [
                {left: '\\[', right: '\\]', display: true},
                {left: '\\(', right: '\\)', display: false},
                { left: '$', right: '$', display: false }
            ]
        });">
</script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<style>
.equation-table {
    background: white;
    border-radius: 8px;
    overflow: hidden;
}

.equation-table table {
    margin-bottom: 0;
}

.equation-table th {
    background: #f8f9fa!important;  /* æµ…ç°è‰²èƒŒæ™¯ */
    color: #2b6cb0!important;       /* ä¸»è“è‰²æ–‡å­— */
    font-weight: 600;              /* åŠ ç²—å­—ä½“ */
    border-bottom: 2px solid #dee2e6!important; /* åº•éƒ¨è¾¹æ¡† */
    vertical-align: middle;        /* å‚ç›´å±…ä¸­ */
    padding: 12px 15px;            /* å†…è¾¹è· */
}

.equation-table td {
    vertical-align: middle;
    padding: 0.75rem;
}

.equation-table input {
    width: 100%;
    text-align: center;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    padding: 0.5rem;
    transition: all 0.3s ease;
}

.equation-table input:focus {
    border-color: var(--primary-blue);
    box-shadow: 0 0 0 3px rgba(43, 108, 176, 0.1);
}

@media (max-width: 768px) {
    .equation-table th, 
    .equation-table td {
        padding: 0.5rem;
        font-size: 0.9rem;
    }
    
    .equation-table input {
        padding: 0.3rem;
    }
}
.equation-card {
    background: white;
    border-radius: 10px;
    padding: 2rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    margin-top: 2rem;
    {#border-left: 5px solid var(--primary-blue);#}
}

.equation-title {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--primary-blue);
    margin-bottom: 1rem;
}

.matrix-inputs .form-control {
    width: 80px;
    height: 38px;
    text-align: center;
    font-size: 1.1rem;
    border: 2px solid #2b6cb0;
    border-radius: 6px;
    transition: all 0.3s ease;
}

.matrix-inputs .form-control:focus {
    border-color: #1c4f91;
    box-shadow: 0 0 8px rgba(43,108,176,0.3);
}

.solution-box {
    background: #fdfdfd;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 1.2rem 1.5rem;
    margin-top: 1rem;
    font-size: 1.05rem;
    line-height: 1.8;
}

.katex-display {
    font-size: 1.2rem;
}

.step-card {
    background: #fff;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.step-header {
    padding: 12px 20px;
    border-bottom: 2px solid;
    font-weight: 600;
}

.step-body {
    padding: 15px 20px;
}

/* æ—¶é—´çº¿å¸ƒå±€ */
.timeline-steps {
    position: relative;
    padding-left: 40px;
}

.timeline-step {
    position: relative;
    margin-bottom: 30px;
}

.step-marker {
    position: absolute;
    left: -40px;
    top: 0;
    width: 30px;
    height: 30px;
    background: #fff;
    border: 2px solid #4a90e2;
    border-radius: 50%;
    text-align: center;
    line-height: 26px;
    font-weight: bold;
    color: #4a90e2;
}

.step-content {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 6px;
    border: 1px solid #dee2e6;
}

.matrix-display {
    overflow-x: auto;
    padding: 10px;
    margin: 10px 0;
}

.step-arrow {
    text-align: center;
    margin: 10px 0;
    color: #6c757d;
}

/* å“åº”å¼ä¼˜åŒ– */
@media (max-width: 768px) {
    .katex-render {
        font-size: 0.9em;
    }

    .timeline-steps {
        padding-left: 30px;
    }

    .step-marker {
        left: -30px;
        width: 25px;
        height: 25px;
        line-height: 21px;
    }
}
</style>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
// è‡ªåŠ¨èšç„¦åˆ°ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†
document.querySelector('input[name="a1"]').focus();

// è¾“å…¥éªŒè¯
document.querySelectorAll('input[type="number"]').forEach(input => {
    input.addEventListener('input', function() {
        this.value = this.value.replace(/[^0-9.\-]/g, '');
    });
});


</script>
{% endblock %}